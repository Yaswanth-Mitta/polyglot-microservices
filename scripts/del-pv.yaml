#!/bin/bash

echo "ğŸš€ Starting Kubernetes cleanup..."

# Step 1: Delete all resources in k8s/ recursively
echo "ğŸ—‘ï¸ Deleting all resources from k8s/ ..."
kubectl delete -f k8s/ --recursive

# Step 2: Delete specific PVCs
echo "ğŸ—‘ï¸ Deleting StatefulSet PVCs ..."
kubectl delete pvc mongo-storage-notes-db-0 --ignore-not-found
kubectl delete pvc mongo-storage-todo-db-0 --ignore-not-found
kubectl delete pvc mongo-storage-user-db-0 --ignore-not-found

# Step 3: Delete leftover PVs (optional cleanup)
echo "ğŸ—‘ï¸ Deleting all PersistentVolumes ..."
kubectl delete pv --all

echo "âœ… Cleanup completed!"

