#!/bin/bash

echo "🚀 Starting Kubernetes cleanup..."

# Step 1: Delete all resources in k8s/ recursively
echo "🗑️ Deleting all resources from k8s/ ..."
kubectl delete -f k8s/ --recursive

# Step 2: Delete specific PVCs
echo "🗑️ Deleting StatefulSet PVCs ..."
kubectl delete pvc mongo-storage-notes-db-0 --ignore-not-found
kubectl delete pvc mongo-storage-todo-db-0 --ignore-not-found
kubectl delete pvc mongo-storage-user-db-0 --ignore-not-found

# Step 3: Delete leftover PVs (optional cleanup)
echo "🗑️ Deleting all PersistentVolumes ..."
kubectl delete pv --all

echo "✅ Cleanup completed!"

